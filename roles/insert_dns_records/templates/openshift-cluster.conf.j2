domain={{ domain }}
{% if write_dnsmasq_config %}
domain-needed
bogus-priv
listen-address=127.0.0.1,{{ ansible_default_ipv4.address }}
expand-hosts
{% if upstream_dns %}
server={{ upstream_dns }}
{% endif %}
{% endif %}

#Wildcard for apps and other api domains
{% for item in dns_records.values() %}
address=/{{ item.address }}/{{ item.ip }}
{% endfor %}

#additional IPs
{% for item in node_dns_records.values() %}
{% if item.use_dhcp %}
dhcp-host={{item.mac}},{{ item.ip }},{{ item.address }}, set:{{ cluster_name }}
{% endif %}
address=/{{ item.address }}/{{ item.ip }}
{% endfor %}

{% for item in extra_dns_records.values() %}
{% if item.use_dhcp %}
dhcp-host={{item.mac}},{{ item.ip }},{{ item.address }}, set:{{ cluster_name }}
{% endif %}
address=/{{ item.address }}/{{ item.ip }}
{% endfor %}
